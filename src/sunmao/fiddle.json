{
  "application": {
    "version": "sunmao/v1",
    "kind": "Application",
    "metadata": {
      "name": "mt"
    },
    "spec": {
      "components": [
        {
          "id": "root1",
          "type": "kui/v1/root",
          "properties": {},
          "traits": [
            {
              "type": "core/v1/style",
              "properties": {
                "styles": []
              }
            }
          ]
        },
        {
          "id": "workload_cluster_form",
          "type": "kui/v1/kubectl_apply_form",
          "properties": {
            "applyConfig": {
              "create": true,
              "patch": true
            },
            "formConfig": {
              "yaml": "apiVersion: kubesmart.smtx.io/v1alpha1\nkind: KubeSmartCluster\nmetadata:\n  name: mycluster\n  namespace: default\nspec:\n  version: v1.23.6\n  controlPlaneEndpoint:\n    host: YOUR_INPUT_VIP\n    port: 6443\n  network:\n    services:\n      cidrBlocks:\n      - 10.96.0.0/12\n    pods:\n      cidrBlocks:\n      - 172.0.0.0/24\n  cni:\n    name: calico\n  topology:\n    controlPlane:\n      name: controlplane\n      replicas: 1\n      nodeConfig:\n        cpuCores: 2\n        memoryMB: 4096\n        diskSizeGB: 40\n        cloneMode: FastClone\n        network:\n          devices:\n          - networkType: IPV4_DHCP\n            vlan: YOUR_INPUT_MGMT_NETWORK_VLAN\n          - networkType: IPV4_DHCP\n            vlan: YOUR_INPUT_STORAGE_NETWORK_VLAN\n    workers:\n    - name: workergroup\n      replicas: 1\n      nodeConfig:\n        cpuCores: 4\n        memoryMB: 12288\n        diskSizeGB: 40\n        cloneMode: FastClone\n        network:\n          devices:\n          - networkType: IPV4_DHCP\n            vlan: YOUR_INPUT_MGMT_NETWORK_VLAN\n            routes:\n            - gateway: 1.2.3.4\n          - networkType: IPV4_DHCP\n            vlan: YOUR_INPUT_STORAGE_NETWORK_VLAN\n            routes:\n            - gateway: 4.3.2.1\n\n  cloudProvider:\n    name: cloudtower\n    cloudtower:\n      server: YOUR_INPUT\n      authMode:\n      username:\n      password:\n      elfCluster:\n      elfVlan:\n      elfVmTemplate:\n      zbsVip:\n  clusterNetwork:\n    pods:\n      cidrBlocks:\n      - \"\"\n    services:\n      cidrBlocks:\n      - \"\"\n  # optional cluster configuration          \n  clusterConfiguration:\n    customImageRegistry: \"registry.smtx.io/kubesmart\"\n    security:\n      sshAuthorizedPubicKey: \"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG05SWM1VyU8lwLjvFVx/crv1IXc10am3bMU1LokWCgz fedora\"\n      sshPassword: \"abc123!@#\"",
              "schemas": [
                {
                  "type": "object",
                  "properties": {
                    "apiVersion": {
                      "type": "string"
                    },
                    "kind": {
                      "type": "string"
                    },
                    "metadata": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "namespace": {
                          "type": "string"
                        },
                        "annotations": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        },
                        "labels": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          }
                        }
                      }
                    },
                    "spec": {
                      "type": "object",
                      "properties": {
                        "cloudProvider": {
                          "type": "object",
                          "required": [
                            "name"
                          ],
                          "properties": {
                            "cloudtower": {
                              "type": "object",
                              "properties": {
                                "authMode": {
                                  "type": "string",
                                  "enum": [
                                    "LOCAL",
                                    "LDAP"
                                  ]
                                },
                                "elfCluster": {
                                  "type": "string"
                                },
                                "elfVlan": {
                                  "type": "string"
                                },
                                "elfVmTemplate": {
                                  "type": "string"
                                },
                                "password": {
                                  "type": "string"
                                },
                                "server": {
                                  "type": "string"
                                },
                                "username": {
                                  "type": "string"
                                },
                                "zbsVip": {
                                  "type": "string"
                                }
                              }
                            },
                            "name": {
                              "type": "string",
                              "enum": [
                                "cloudtower",
                                "vsphere"
                              ]
                            }
                          }
                        },
                        "clusterConfiguration": {
                          "type": "object",
                          "properties": {
                            "caCerts": {
                              "type": "string"
                            },
                            "customImageRegistry": {
                              "type": "string"
                            },
                            "proxy": {
                              "type": "object",
                              "properties": {
                                "http": {
                                  "type": "string"
                                },
                                "https": {
                                  "type": "string"
                                },
                                "noProxy": {
                                  "type": "string"
                                }
                              }
                            },
                            "security": {
                              "type": "object",
                              "properties": {
                                "sshAuthorizedPubicKey": {
                                  "type": "string"
                                },
                                "sshPassword": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        },
                        "clusterNetwork": {
                          "type": "object",
                          "properties": {
                            "apiServerPort": {
                              "type": "integer",
                              "format": "int32"
                            },
                            "pods": {
                              "type": "object",
                              "required": [
                                "cidrBlocks"
                              ],
                              "properties": {
                                "cidrBlocks": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            },
                            "serviceDomain": {
                              "type": "string"
                            },
                            "services": {
                              "type": "object",
                              "required": [
                                "cidrBlocks"
                              ],
                              "properties": {
                                "cidrBlocks": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              }
                            }
                          }
                        },
                        "cni": {
                          "type": "object",
                          "properties": {
                            "name": {
                              "type": "string",
                              "enum": [
                                "calico",
                                "everoute"
                              ]
                            },
                            "version": {
                              "type": "string"
                            }
                          }
                        },
                        "components": {
                          "type": "object",
                          "properties": {
                            "loadbalancer": {
                              "type": "object",
                              "properties": {
                                "enabled": {
                                  "type": "boolean"
                                },
                                "metallb": {
                                  "type": "object",
                                  "properties": {
                                    "config": {
                                      "type": "object",
                                      "properties": {
                                        "secretRef": {
                                          "type": "object",
                                          "properties": {
                                            "name": {
                                              "type": "string"
                                            },
                                            "namespace": {
                                              "type": "string"
                                            }
                                          }
                                        },
                                        "yaml": {
                                          "type": "string"
                                        }
                                      }
                                    },
                                    "disabled": {
                                      "type": "boolean"
                                    },
                                    "version": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "logging": {
                              "type": "object",
                              "properties": {
                                "elasticcurator": {
                                  "type": "object",
                                  "properties": {
                                    "config": {
                                      "type": "object",
                                      "properties": {
                                        "secretRef": {
                                          "type": "object",
                                          "properties": {
                                            "name": {
                                              "type": "string"
                                            },
                                            "namespace": {
                                              "type": "string"
                                            }
                                          }
                                        },
                                        "yaml": {
                                          "type": "string"
                                        }
                                      }
                                    },
                                    "disabled": {
                                      "type": "boolean"
                                    },
                                    "version": {
                                      "type": "string"
                                    }
                                  }
                                },
                                "elasticsearch": {
                                  "type": "object",
                                  "properties": {
                                    "config": {
                                      "type": "object",
                                      "properties": {
                                        "secretRef": {
                                          "type": "object",
                                          "properties": {
                                            "name": {
                                              "type": "string"
                                            },
                                            "namespace": {
                                              "type": "string"
                                            }
                                          }
                                        },
                                        "yaml": {
                                          "type": "string"
                                        }
                                      }
                                    },
                                    "disabled": {
                                      "type": "boolean"
                                    },
                                    "version": {
                                      "type": "string"
                                    }
                                  }
                                },
                                "enabled": {
                                  "type": "boolean"
                                },
                                "fluentbit": {
                                  "type": "object",
                                  "properties": {
                                    "config": {
                                      "type": "object",
                                      "properties": {
                                        "secretRef": {
                                          "type": "object",
                                          "properties": {
                                            "name": {
                                              "type": "string"
                                            },
                                            "namespace": {
                                              "type": "string"
                                            }
                                          }
                                        },
                                        "yaml": {
                                          "type": "string"
                                        }
                                      }
                                    },
                                    "disabled": {
                                      "type": "boolean"
                                    },
                                    "version": {
                                      "type": "string"
                                    }
                                  }
                                },
                                "kibana": {
                                  "type": "object",
                                  "properties": {
                                    "config": {
                                      "type": "object",
                                      "properties": {
                                        "secretRef": {
                                          "type": "object",
                                          "properties": {
                                            "name": {
                                              "type": "string"
                                            },
                                            "namespace": {
                                              "type": "string"
                                            }
                                          }
                                        },
                                        "yaml": {
                                          "type": "string"
                                        }
                                      }
                                    },
                                    "disabled": {
                                      "type": "boolean"
                                    },
                                    "version": {
                                      "type": "string"
                                    }
                                  }
                                },
                                "loggingoperator": {
                                  "type": "object",
                                  "properties": {
                                    "config": {
                                      "type": "object",
                                      "properties": {
                                        "secretRef": {
                                          "type": "object",
                                          "properties": {
                                            "name": {
                                              "type": "string"
                                            },
                                            "namespace": {
                                              "type": "string"
                                            }
                                          }
                                        },
                                        "yaml": {
                                          "type": "string"
                                        }
                                      }
                                    },
                                    "disabled": {
                                      "type": "boolean"
                                    },
                                    "version": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            },
                            "monitoring": {
                              "type": "object",
                              "properties": {
                                "enabled": {
                                  "type": "boolean"
                                },
                                "kubeprometheus": {
                                  "type": "object",
                                  "properties": {
                                    "config": {
                                      "type": "object",
                                      "properties": {
                                        "secretRef": {
                                          "type": "object",
                                          "properties": {
                                            "name": {
                                              "type": "string"
                                            },
                                            "namespace": {
                                              "type": "string"
                                            }
                                          }
                                        },
                                        "yaml": {
                                          "type": "string"
                                        }
                                      }
                                    },
                                    "disabled": {
                                      "type": "boolean"
                                    },
                                    "version": {
                                      "type": "string"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        },
                        "controlPlaneEndpoint": {
                          "type": "object",
                          "required": [
                            "host",
                            "port"
                          ],
                          "properties": {
                            "host": {
                              "type": "string"
                            },
                            "port": {
                              "type": "integer",
                              "format": "int32"
                            }
                          }
                        },
                        "topology": {
                          "type": "object",
                          "properties": {
                            "controlPlane": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "nodeConfig": {
                                  "type": "object",
                                  "properties": {
                                    "cloneMode": {
                                      "type": "string"
                                    },
                                    "cpuCores": {
                                      "type": "integer",
                                      "format": "int32"
                                    },
                                    "diskSizeGB": {
                                      "type": "integer",
                                      "format": "int32"
                                    },
                                    "memoryMB": {
                                      "type": "integer",
                                      "format": "int32"
                                    },
                                    "network": {
                                      "type": "object",
                                      "required": [
                                        "devices"
                                      ],
                                      "properties": {
                                        "devices": {
                                          "type": "array",
                                          "items": {
                                            "type": "object",
                                            "required": [
                                              "networkType"
                                            ],
                                            "properties": {
                                              "ipAddrs": {
                                                "type": "array",
                                                "items": {
                                                  "type": "string"
                                                }
                                              },
                                              "macAddr": {
                                                "type": "string"
                                              },
                                              "netmask": {
                                                "type": "string"
                                              },
                                              "networkType": {
                                                "type": "string"
                                              },
                                              "routes": {
                                                "type": "array",
                                                "items": {
                                                  "type": "object",
                                                  "properties": {
                                                    "gateway": {
                                                      "type": "string"
                                                    },
                                                    "netmask": {
                                                      "type": "string"
                                                    },
                                                    "network": {
                                                      "type": "string"
                                                    }
                                                  }
                                                }
                                              },
                                              "vlan": {
                                                "type": "string"
                                              }
                                            }
                                          }
                                        }
                                      }
                                    },
                                    "vmTemplate": {
                                      "type": "string"
                                    }
                                  }
                                },
                                "replicas": {
                                  "type": "integer",
                                  "format": "int32"
                                }
                              }
                            },
                            "workers": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "name": {
                                    "type": "string"
                                  },
                                  "nodeConfig": {
                                    "type": "object",
                                    "properties": {
                                      "cloneMode": {
                                        "type": "string"
                                      },
                                      "cpuCores": {
                                        "type": "integer",
                                        "format": "int32"
                                      },
                                      "diskSizeGB": {
                                        "type": "integer",
                                        "format": "int32"
                                      },
                                      "memoryMB": {
                                        "type": "integer",
                                        "format": "int32"
                                      },
                                      "network": {
                                        "type": "object",
                                        "required": [
                                          "devices"
                                        ],
                                        "properties": {
                                          "devices": {
                                            "type": "array",
                                            "items": {
                                              "type": "object",
                                              "required": [
                                                "networkType"
                                              ],
                                              "properties": {
                                                "ipAddrs": {
                                                  "type": "array",
                                                  "items": {
                                                    "type": "string"
                                                  }
                                                },
                                                "macAddr": {
                                                  "type": "string"
                                                },
                                                "netmask": {
                                                  "type": "string"
                                                },
                                                "networkType": {
                                                  "type": "string"
                                                },
                                                "routes": {
                                                  "type": "array",
                                                  "items": {
                                                    "type": "object",
                                                    "properties": {
                                                      "gateway": {
                                                        "type": "string"
                                                      },
                                                      "netmask": {
                                                        "type": "string"
                                                      },
                                                      "network": {
                                                        "type": "string"
                                                      }
                                                    }
                                                  }
                                                },
                                                "vlan": {
                                                  "type": "string"
                                                }
                                              }
                                            }
                                          }
                                        }
                                      },
                                      "vmTemplate": {
                                        "type": "string"
                                      }
                                    }
                                  },
                                  "replicas": {
                                    "type": "integer",
                                    "format": "int32"
                                  }
                                }
                              }
                            }
                          }
                        },
                        "version": {
                          "type": "string"
                        }
                      }
                    }
                  },
                  "x-kubernetes-group-version-kind": [
                    {
                      "group": "kubesmart.smtx.io",
                      "kind": "KubeSmartCluster",
                      "version": "v1alpha1"
                    }
                  ]
                }
              ],
              "defaultValues": [
                {
                  "apiVersion": "kubesmart.smtx.io/v1alpha1",
                  "kind": "KubeSmartCluster",
                  "metadata": {
                    "name": "mycluster",
                    "namespace": "default"
                  },
                  "spec": {
                    "version": "v1.23.6",
                    "controlPlaneEndpoint": {
                      "host": "YOUR_INPUT_VIP",
                      "port": 6443
                    },
                    "network": {
                      "services": {
                        "cidrBlocks": [
                          "10.96.0.0/12"
                        ]
                      },
                      "pods": {
                        "cidrBlocks": [
                          "172.0.0.0/24"
                        ]
                      }
                    },
                    "cni": {
                      "name": "calico"
                    },
                    "topology": {
                      "controlPlane": {
                        "name": "controlplane",
                        "replicas": 1,
                        "nodeConfig": {
                          "cpuCores": 2,
                          "memoryMB": 4096,
                          "diskSizeGB": 40,
                          "cloneMode": "FastClone",
                          "network": {
                            "devices": [
                              {
                                "networkType": "IPV4_DHCP",
                                "vlan": "YOUR_INPUT_MGMT_NETWORK_VLAN"
                              },
                              {
                                "networkType": "IPV4_DHCP",
                                "vlan": "YOUR_INPUT_STORAGE_NETWORK_VLAN"
                              }
                            ]
                          }
                        }
                      },
                      "workers": [
                        {
                          "name": "workergroup",
                          "replicas": 1,
                          "nodeConfig": {
                            "cpuCores": 4,
                            "memoryMB": 12288,
                            "diskSizeGB": 40,
                            "cloneMode": "FastClone",
                            "network": {
                              "devices": [
                                {
                                  "networkType": "IPV4_DHCP",
                                  "vlan": "YOUR_INPUT_MGMT_NETWORK_VLAN",
                                  "routes": [
                                    {
                                      "gateway": "1.2.3.4"
                                    }
                                  ]
                                },
                                {
                                  "networkType": "IPV4_DHCP",
                                  "vlan": "YOUR_INPUT_STORAGE_NETWORK_VLAN",
                                  "routes": [
                                    {
                                      "gateway": "4.3.2.1"
                                    }
                                  ]
                                }
                              ]
                            }
                          }
                        }
                      ]
                    },
                    "cloudProvider": {
                      "name": "cloudtower",
                      "cloudtower": {
                        "server": "YOUR_INPUT",
                        "authMode": null,
                        "username": null,
                        "password": null,
                        "elfCluster": null,
                        "elfVlan": null,
                        "elfVmTemplate": null,
                        "zbsVip": null
                      }
                    },
                    "clusterNetwork": {
                      "pods": {
                        "cidrBlocks": [
                          ""
                        ]
                      },
                      "services": {
                        "cidrBlocks": [
                          ""
                        ]
                      }
                    },
                    "clusterConfiguration": {
                      "customImageRegistry": "registry.smtx.io/kubesmart",
                      "security": {
                        "sshAuthorizedPubicKey": "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIG05SWM1VyU8lwLjvFVx/crv1IXc10am3bMU1LokWCgz fedora",
                        "sshPassword": "abc123!@#"
                      }
                    }
                  }
                }
              ],
              "uiConfig": {
                "allowTogggleYaml": false,
                "layout": {
                  "type": "wizard",
                  "steps": [
                    {
                      "title": "基本信息",
                      "fields": [
                        {
                          "path": "0.metadata.name",
                          "label": "名称",
                          "helperText": "",
                          "sectionTitle": "",
                          "widget": "",
                          "error": ""
                        },
                        {
                          "path": "0.spec.cloudProvider.cloudtower.elfCluster",
                          "label": "创建位置",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.version",
                          "label": "Kubernetes 版本",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        }
                      ],
                      "prevText": "上一步",
                      "nextText": "下一步"
                    },
                    {
                      "title": "节点配置",
                      "fields": [
                        {
                          "path": "0.spec.topology.controlPlane.name",
                          "label": "节点组名称",
                          "helperText": "",
                          "sectionTitle": "控制节点组",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.controlPlane.replicas",
                          "label": "节点数量",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.controlPlane.nodeConfig.cpuCores",
                          "label": "CPU",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.controlPlane.nodeConfig.memoryMB",
                          "label": "内存",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.controlPlane.nodeConfig.diskSizeGB",
                          "label": "存储",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.controlPlane.nodeConfig.network.devices",
                          "label": "虚拟网卡",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.workers",
                          "label": "",
                          "helperText": "",
                          "sectionTitle": "计算节点组",
                          "error": "",
                          "widget": "none"
                        },
                        {
                          "path": "0.spec.topology.workers.$i.name",
                          "label": "节点组名称",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.workers.$i.replicas",
                          "label": "节点数量",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.workers.$i.nodeConfig.cpuCores",
                          "label": "CPU",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.workers.$i.nodeConfig.memoryMB",
                          "label": "内存",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.workers.$i.nodeConfig.diskSizeGB",
                          "label": "存储",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.workers.$i.nodeConfig.network.devices",
                          "label": "虚拟网卡",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.topology.workers.$add",
                          "label": "",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.clusterConfiguration.security.sshAuthorizedPubicKey",
                          "label": "节点访问配置",
                          "helperText": "",
                          "sectionTitle": "其他配置",
                          "error": "",
                          "widget": ""
                        }
                      ],
                      "disabled": false,
                      "prevText": "上一步",
                      "nextText": "下一步"
                    },
                    {
                      "title": "网络配置",
                      "fields": [
                        {
                          "path": "0.spec.controlPlaneEndpoint.host",
                          "label": "Control Plane VIP",
                          "helperText": "",
                          "sectionTitle": "基础配置",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.cni.name",
                          "label": "Network Provider",
                          "helperText": "",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.clusterNetwork.services.cidrBlocks.$i",
                          "label": "Service 地址范围",
                          "helperText": "示例：192.168.0.0/16",
                          "sectionTitle": "高级配置",
                          "error": "",
                          "widget": ""
                        },
                        {
                          "path": "0.spec.clusterNetwork.pods.cidrBlocks.$i",
                          "label": "Pod 地址范围",
                          "helperText": "示例：192.168.0.0/16",
                          "sectionTitle": "",
                          "error": "",
                          "widget": ""
                        }
                      ],
                      "disabled": false,
                      "prevText": "上一步",
                      "nextText": "创建"
                    }
                  ]
                },
                "cancelText": "取消"
              }
            },
            "k8sConfig": {
              "basePath": ""
            }
          },
          "traits": [
            {
              "type": "core/v1/slot",
              "properties": {
                "container": {
                  "id": "root1",
                  "slot": "root"
                },
                "ifCondition": true
              }
            },
            {
              "type": "core/v1/event",
              "properties": {
                "handlers": []
              }
            }
          ]
        }
      ]
    }
  },
  "modules": []
}